CREATE OR REPLACE TRIGGER CHECK_QUANTITY
BEFORE INSERT OR UPDATE ON ORDERED_BOOKS
FOR EACH ROW
BEGIN
    IF:NEW.QUANTITY <= 0 THEN
    RAISE_APPLICATION_ERROR(-20001, 'Quantity must be positive!');
    END IF;
END;
/

CREATE OR REPLACE TRIGGER CHECK_CUSTOMER_EMAIL
BEFORE INSERT OR UPDATE ON CUSTOMER
FOR EACH ROW
BEGIN
    IF :NEW.EMAIL NOT LIKE '%@%.%' THEN
        RAISE_APPLICATION_ERROR(-20002, 'Invalid email format!');
    END IF;
END;
/

CREATE OR REPLACE TRIGGER SET_ORDER_DATE
BEFORE INSERT ON ORDERS
FOR EACH ROW
BEGIN
    IF :NEW.ORDER_DATE IS NULL THEN
        :NEW.ORDER_DATE := SYSDATE;
    END IF;
END;
/

CREATE OR REPLACE TRIGGER UPDATE_ORDER_PRICE_TOTAL
AFTER INSERT ON ORDERED_BOOKS
FOR EACH ROW
BEGIN
    UPDATE ORDERS
    SET PRICE = NVL(PRICE, 0) + (:NEW.QUANTITY * :NEW.PRICE)
    WHERE ORDER_ID = :NEW.ORDER_ID;
END;
/

CREATE OR REPLACE TRIGGER AUTOGEN_CUSTOMER
BEFORE INSERT ON CUSTOMER
FOR EACH ROW
WHEN (NEW.CUSTOMER_ID IS NULL)
BEGIN
    :NEW.CUSTOMER_ID := SEQ_CUSTOMER_ID.NEXTVAL;
END;
/

CREATE OR REPLACE TRIGGER TRG_AUTOGEN_ORDER
BEFORE INSERT ON ORDERS
FOR EACH ROW
WHEN (NEW.ORDER_ID IS NULL)
BEGIN
    :NEW.ORDER_ID := SEQ_ORDER_ID.NEXTVAL;
END;
/

CREATE OR REPLACE TRIGGER TRG_AUTOGEN_GENRE
BEFORE INSERT ON GENRE
FOR EACH ROW
WHEN (NEW.GENRE_ID IS NULL)
BEGIN
    :NEW.GENRE_ID := SEQ_GENRE_ID.NEXTVAL;
END;
/

CREATE OR REPLACE TRIGGER TRG_AUTOGEN_AUTHOR
BEFORE INSERT ON AUTHOR
FOR EACH ROW
WHEN (NEW.AUTHOR_ID IS NULL)
BEGIN
    :NEW.AUTHOR_ID := SEQ_AUTHOR_ID.NEXTVAL;
END;
/

CREATE OR REPLACE TRIGGER TRG_AUTOGEN_POSITION
BEFORE INSERT ON WORK_POSITIONS
FOR EACH ROW
WHEN (NEW.POSITION_ID IS NULL)
BEGIN
    :NEW.POSITION_ID := SEQ_POSITION_ID.NEXTVAL;
END;
/

CREATE OR REPLACE TRIGGER TRG_AUTOGEN_EMPLOYEE
BEFORE INSERT ON EMPLOYEE
FOR EACH ROW
WHEN (NEW.EMPLOYEE_ID IS NULL)
BEGIN
    :NEW.EMPLOYEE_ID := SEQ_EMPLOYEE_ID.NEXTVAL;
END;
/

CREATE OR REPLACE TRIGGER TRG_AUTOGEN_PUBLISHER
BEFORE INSERT ON PUBLISHER
FOR EACH ROW
WHEN (NEW.PUBLISHER_ID IS NULL)
BEGIN
    :NEW.PUBLISHER_ID := SEQ_PUBLISHER_ID.NEXTVAL;
END;
/

CREATE OR REPLACE TRIGGER TRG_AUTOGEN_BOOK
BEFORE INSERT ON BOOK
FOR EACH ROW
WHEN (NEW.BOOK_ID IS NULL)
BEGIN
    :NEW.BOOK_ID := SEQ_BOOK_ID.NEXTVAL;
END;
/